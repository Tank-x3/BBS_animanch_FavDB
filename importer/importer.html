<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fav-DB Importer</title>
    <link rel="stylesheet" href="importer.css">
</head>
<body>
    <header>
        <h1>Fav-DB Importer</h1>
    </header>

    <main>
        <!-- PC用レイアウト -->
        <div id="pc-layout" class="layout-container">
            <div class="file-panel" id="db-panel">
                <h2>① 既存のデータベース (任意)</h2>
                <div class="drop-area" id="db-drop-area">
                    <p>fav_database.json をここにD&D<br>またはクリックして選択</p>
                    <input type="file" id="db-file-input" accept=".json" class="file-input">
                </div>
                <div id="db-info" class="file-info"></div>
            </div>

            <div class="file-panel" id="add-panel">
                <h2>② 追加するお気に入りファイル</h2>
                <div class="drop-area" id="add-drop-area">
                    <p>html / mht / json ファイルをここにD&D<br>またはクリックして選択 (複数可)</p>
                    <input type="file" id="add-file-input" class="file-input" multiple>
                </div>
                <div id="add-info" class="file-info"></div>
            </div>

            <div class="merge-panel">
                <div id="processing-indicator" class="hidden">処理中...</div>
                <button id="download-button" disabled>↓ 結合してダウンロード ↓</button>
            </div>
        </div>

        <!-- スマートフォン用レイアウト -->
        <div id="sp-layout" class="layout-container">
            <div id="step1" class="step active">
                <h2>STEP 1: データベースの選択 (任意)</h2>
                <p>既存の fav_database.json があれば読み込ませてください。新規作成の場合はスキップできます。</p>
                <div class="drop-area" id="sp-db-drop-area">
                    <p>[ ＋ ファイルを選択 ]</p>
                    <input type="file" id="sp-db-file-input" accept=".json" class="file-input">
                </div>
                <div id="sp-db-info" class="file-info"></div>
                <button class="nav-button next" data-target="step2">▶ 次へ (新規作成)</button>
            </div>

            <div id="step2" class="step">
                <button class="nav-button back" data-target="step1">◀ 戻る</button>
                <h2>STEP 2: お気に入りファイルの追加</h2>
                <p>html, mht, json ファイルを追加してください。(複数選択可)</p>
                <div class="drop-area" id="sp-add-drop-area">
                    <p>[ ＋ ファイルを選択 ]</p>
                    <input type="file" id="sp-add-file-input" class="file-input" multiple>
                </div>
                <div id="sp-add-info" class="file-info"></div>
                <button class="nav-button next" data-target="step3" disabled>▶ 結果を確認する</button>
            </div>

            <div id="step3" class="step">
                <button class="nav-button back" data-target="step2">◀ 戻る</button>
                <h2>STEP 3: 確認と保存</h2>
                <div id="processing-indicator-sp" class="hidden">処理中...</div>
                <div class="summary">
                    <p>元データ: <span id="summary-db-count">0</span>件</p>
                    <p>追加データ: <span id="summary-add-count">0</span>件</p>
                    <hr>
                    <p><strong>合計: <span id="summary-total-count">0</span>件</strong></p>
                </div>
                <button id="sp-download-button" disabled>ダウンロード (fav_database.json)</button>
            </div>
        </div>

    </main>
    
    <div id="error-message" class="error-message hidden"></div>

    <!-- 競合解決モーダル -->
    <div id="conflict-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="conflict-title">データ競合の解決</h2>
            </div>
            <div class="modal-body" id="conflict-body">
                <!-- JSで動的にコンテンツ生成 -->
            </div>
        </div>
    </div>


    <script src="importer.js"></script>
</body>
</html>